<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ChessGame</title>
    <link rel="stylesheet"
          href="css/chessboard-1.0.0.min.css">
</head>
<body>
<div id="myBoard" style="width: 980px; position: absolute;  top:0;right:0; bottom:0; left:0;"></div>

<script src="js/jquery-3.5.1.min.js"></script>
<script src="js/chessboard.js"></script>
<script src="js/chess.js"></script>

<script>

    var board = null
    var game = new Chess()

    function onDragStart(source, piece, position, orientation) {
        console.log("onDragStart", source, piece, position, orientation)
        // do not pick up pieces if the game is over
        if (game.game_over()) return false

        // only pick up pieces for White
        if (piece.search(/^b/) !== -1) return false
    }

    function makeRandomMove() {
        var possibleMoves = game.moves()

        // game over
        if (possibleMoves.length === 0) return

        var randomIdx = Math.floor(Math.random() * possibleMoves.length)
        game.move(possibleMoves[randomIdx])
        board.position(game.fen())
    }

    function onDrop(source, target) {
        console.log("OnDrop", source, target)
        // see if the move is legal
        var move = game.move({
            from: source,
            to: target,
            promotion: 'q' // NOTE: always promote to a queen for example simplicity
        })

        // illegal move
        if (move === null) return 'snapback'

        // make random legal move for black
        window.setTimeout(makeRandomMove, 250)
    }

    // update the board position after the piece snap
    // for castling, en passant, pawn promotion
    function onSnapEnd() {
        console.log("onSnapEnd")
        board.position(game.fen())
    }

    function onMouseClick() {
        console.log("onMouseClick")
    }

    var config = {
        draggable: true,
        position: 'start',
        onDragStart: onDragStart,
        onDrop: onDrop,
        onSnapEnd: onSnapEnd,
        onMouseClick: onMouseClick
    }
    board = Chessboard('myBoard', config)
</script>
</body>
</html>